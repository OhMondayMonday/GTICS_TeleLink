<!doctype html>
<html lang="en">


    <!-- Mirrored from themesdesign.in/nazox/layouts/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 30 Aug 2024 19:30:18 GMT -->
    <head th:replace="~{Superadmin/fragments/head.html :: head(title='Perfil')}"></head>

    <body data-sidebar="dark" class="vertical-collpsed">

        <!-- <body data-layout="horizontal" data-topbar="dark"> -->

        <!-- Begin page -->
        <div id="layout-wrapper">


            <div th:replace="~{Superadmin/fragments/header.html :: header(title='Perfil')}"></div>

            <!-- ========== Left Sidebar Start ========== -->
            <div th:replace="~{Superadmin/fragments/sidebar.html :: sidebar}"></div>
            <!-- Left Sidebar End -->


            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <div class="main-content">

                <div class="page-content" style="min-height: 100%;">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                    <h4 class="mb-sm-0">Detalles de perfil</h4>
                                    <div class="page-title-right">
                                        <a th:href="@{/superadmin/usuarios}" class="btn ms-2 btn-outline-primary">
                                            < Regresar a lista de usuarios
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xxl-3 col-xl-4">
                                <div class="row">
                                    <div class="card px-0 rounded-4" style="min-height: 40vh; background-color: #eff4fb;">
                                        <div class="card-body px-4">
                                            <div class="position-relative start-0 top-0 p-0 m-0">
                                                <a th:href="@{'/superadmin/usuarios/editar/' + ${usuario.usuarioId}}"
                                                   class="me-2 btn btn-sm btn-primary"
                                                   data-bs-toggle="tooltip"
                                                   data-bs-placement="center"
                                                   title="Editar">
                                                    <i class="mdi mdi-pencil font-size-20"></i>
                                                </a>
                                                <div class="user-actions d-inline-block">
                                                    <!-- Botón Banear (solo visible si no está baneado) -->
                                                    <form th:if="${usuario.estadoCuenta.name() != 'baneado'}"
                                                          th:action="@{/superadmin/usuarios/{id}/banear(id=${usuario.usuarioId})}"
                                                          method="post"
                                                          class="d-inline">
                                                        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                                                        <button type="button"
                                                                class="me-2 btn btn-sm btn-danger"
                                                                onclick="confirmarBaneo(this)"
                                                                data-bs-toggle="tooltip"
                                                                data-bs-placement="top"
                                                                title="Banear usuario">
                                                            <i class="mdi mdi-account-cancel font-size-18"></i>
                                                        </button>
                                                    </form>

                                                    <!-- Botón Activar (solo visible si está baneado) -->
                                                    <form th:if="${usuario.estadoCuenta.name() == 'baneado'}"
                                                          th:action="@{/superadmin/usuarios/{id}/activar(id=${usuario.usuarioId})}"
                                                          method="post"
                                                          class="d-inline">
                                                        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                                                        <button type="submit"
                                                                class="me-2 btn btn-sm btn-success"
                                                                data-bs-toggle="tooltip"
                                                                data-bs-placement="top"
                                                                title="Activar usuario">
                                                            <i class="mdi mdi-account-check font-size-18"></i>
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                            <div class="text-center mt-0">
                                                <div class="chat-avtar d-inline-flex mx-auto">
                                                    <img class="rounded-circle img-fluid avatar-xl wid-70"
                                                         th:src="${usuario.fotoPerfilUrl != null ? usuario.fotoPerfilUrl : '/assets/images/users/avatar-4.jpg'}"
                                                         alt="User image">
                                                </div>
                                                <h5 class="mb-0" th:text="${usuario.nombres + ' ' + usuario.apellidos}">Nombre Usuario</h5>
                                                <p class="text-muted text-sm mb-1" th:text="${usuario.dni}">DNI</p>
                                                <span th:switch="${usuario.estadoCuenta.name()}" class="badge font-size-14">
                                                  <span th:case="activo" class="badge bg-success">Activo</span>
                                                  <span th:case="baneado" class="badge bg-danger">Baneado</span>
                                                  <span th:case="pendiente" class="badge bg-warning">Pendiente</span>
                                                </span>
                                                <hr class="my-2 border border-light-subtle">
                                                <div class="row g-3">
                                                    <div class="col-4">
                                                        <h5 class="mb-0" th:text="${#lists.size(reservas)}">0</h5>
                                                        <small class="text-muted">Reservas</small>
                                                    </div>
                                                    <div class="col-4 border border-top-0 border-bottom-0">
                                                        <h5 class="mb-0" th:text="${#lists.size(reservas)}">-</h5>
                                                        <small class="text-muted">Reservas totales</small>
                                                    </div>
                                                    <div class="col-4">
                                                        <h5 class="mb-0">-</h5>
                                                        <small class="text-muted">Baneos</small>
                                                    </div>
                                                </div>
                                                <hr class="my-2 border border-light-subtle">

                                                <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3 mt-1" th:if="${usuario.telefono != null}">
                                                    <i class="ri-phone-fill me-2"></i>
                                                    <p class="mb-0" th:text="${usuario.telefono}">Teléfono</p>
                                                </div>
                                                <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3" th:if="${usuario.direccion != null}">
                                                    <i class="ri-map-pin-2-line me-2"></i>
                                                    <p class="mb-0" th:text="${usuario.direccion}">Dirección</p>
                                                </div>
                                                <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3">
                                                    <i class="ri-mail-fill me-2"></i>
                                                    <p class="mb-0" th:text="${usuario.correoElectronico}">Email</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="card px-0" style="background-color: #eff4fb;">
                                        <div class="card-header mb-0">Información de cuenta</div>
                                        <div class="card-body py-2">
                                            <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3 mt-1">
                                                <i class="ri-calendar-2-fill me-2"></i>
                                                <span class="mb-0">Creación de cuenta: </span>
                                                <span class="px-1 mb-0" th:text="${#temporals.format(usuario.fechaCreacion, 'dd/MM/yyyy')}">Fecha</span>
                                            </div>
                                            <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3">
                                                <i class="ri-calendar-2-fill me-2"></i>
                                                <span class="mb-0">Última modificación: </span>
                                                <span class="px-1 mb-0" th:text="${usuario.fechaActualizacion != null} ? ${#temporals.format(usuario.fechaActualizacion, 'dd/MM/yyyy')} : 'Sin modificaciones'">Fecha</span>
                                            </div>
                                            <div class="d-inline-flex align-items-center justify-content-start w-100 mb-3">
                                                <i class="ri-calendar-2-fill me-2"></i>
                                                <span class="mb-0">Rol: </span>
                                                <span class="px-2 mb-0">
                          <span class="badge bg-primary font-size-14" th:text="${usuario.rol.getRol()}">Rol</span>
                        </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xxl-9 col-xl-8">
                                <div class="card">
                                    <div class="card-header pb-1">
                                        <div class="d-flex">
                                            <h4 class="card-title my-2">Reservas del usuario</h4>
                                        </div>
                                    </div>
                                    <div class="card-body pt-2">
                                        <div class="mb-2 ms-1">
                                            <ul class="nav nav-tabs nav-tabs-custom nav-justified" id="myTab" role="tablist">
                                                <li class="nav-item" role="presentation">
                                                    <a class="nav-link active" id="reservas-tab" data-bs-toggle="tab"
                                                       data-bs-target="#reservas" type="button" role="tab"
                                                       aria-controls="reservas" aria-selected="true">Reservas
                                                    </a>
                                                </li>
                                                <li class="nav-item" role="presentation">
                                                    <a class="nav-link" id="pagos-tab" data-bs-toggle="tab"
                                                       data-bs-target="#pagos" type="button" role="tab"
                                                       aria-controls="pagos" aria-selected="false">Pagos
                                                    </a>
                                                </li>
                                                <li class="nav-item" role="presentation">
                                                    <a class="nav-link" id="reembolsos-tab" data-bs-toggle="tab"
                                                            data-bs-target="#reembolsos" type="button" role="tab"
                                                            aria-controls="reembolsos" aria-selected="false">Reembolsos
                                                    </a>
                                                </li>
                                            </ul>
                                            <div class="tab-content" id="myTabContent">
                                                <div class="tab-pane fade show active" id="reservas" role="tabpanel" aria-labelledby="reservas-tab">

                                                  <div class="mt-3">
                                                    <h4 class="card-title mb-1">Reservas realizadas</h4>
                                                    <p class="card-title-desc mb-0 mt-0">
                                                      Lista de Reservas del usuario
                                                    </p>
                                                  </div>

                                                  <!-- Export buttons for Reservas -->
                                                  <div id="export-buttons-container-reservas" class="d-none">
                                                    <div class="btn-group" role="group">
                                                      <a href="#" id="exportExcelReservas" class="btn btn-success btn-sm" style="min-width: 120px;">
                                                        <i class="fas fa-file-excel me-1"></i>
                                                        Exportar Excel
                                                      </a>
                                                      <a href="#" id="exportPdfReservas" class="btn btn-danger btn-sm" style="min-width: 120px;">
                                                        <i class="fas fa-file-pdf me-1"></i>
                                                        Exportar PDF
                                                      </a>
                                                    </div>
                                                  </div>

                                                  <!-- Loader for Reservas -->
                                                  <div id="loading-container-reservas" class="text-center p-4">
                                                    <div class="spinner-border text-primary" role="status">
                                                      <span class="visually-hidden">Cargando...</span>
                                                    </div>
                                                    <div class="mt-2">Cargando reservas...</div>
                                                  </div>

                                                  <!-- Tabla envuelta en contenedor oculto -->
                                                  <div id="table-content-reservas" style="display: none;">
                                                    <div class="table-responsive">
                                                      <table id="alternative-page-datatable" class="table table-centered datatable dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                        <thead>
                                                            <tr>
                                                                <th style="width: 40px">ID</th>
                                                                <th>Espacio</th>
                                                                <th>Servicio</th>
                                                                <th>Inicio</th>
                                                                <th>Fin</th>
                                                                <th>Estado</th>
                                                                <th style="width: 100px">Acción</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr th:each="reserva : ${reservas}">
                                                                <td th:text="${reserva.reservaId}"></td>
                                                                <td th:text="${reserva.espacioDeportivo.nombre}"></td>
                                                                <td th:text="${reserva.espacioDeportivo.servicioDeportivo.getServicioDeportivo()}"></td>
                                                                <td th:text="${#temporals.format(reserva.inicioReserva, 'dd/MM/yyyy HH:mm')}"></td>
                                                                <td th:text="${#temporals.format(reserva.finReserva, 'dd/MM/yyyy HH:mm')}"></td>
                                                                <td>
                                                                    <span th:switch="${reserva.estado.name()}" class="badge">
                                                                        <span th:case="pendiente" class="badge  bg-warning-subtle text-warning font-size-12">Pendiente</span>
                                                                        <span th:case="confirmada" class="badge  bg-primary-subtle text-primary font-size-12">Confirmada</span>
                                                                        <span th:case="cancelada" class="badge bg-danger-subtle text-danger font-size-12">Cancelado</span>
                                                                        <span th:case="completada" class="badge bg-success-subtle text-success font-size-12">Completado</span>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <a th:href="@{'/superadmin/reservas/' + ${reserva.reservaId}}"
                                                                       class="me-2 text-primary"
                                                                       data-bs-container="#tooltip-container"
                                                                       data-bs-toggle="tooltip"
                                                                       data-bs-placement="center"
                                                                       title="Detalles">
                                                                        <i class="mdi mdi-eye font-size-20"></i>
                                                                    </a>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                      </table>
                                                    </div>
                                                  </div>

                                                </div>

                                                <div class="tab-pane fade" id="pagos" role="tabpanel"
                                                     aria-labelledby="pagos-tab">

                                                    <div class="mt-3">
                                                        <h4 class="card-title mb-1">Pagos realizados</h4>
                                                        <p class="card-title-desc mb-0 mt-0">
                                                            Lista de Pagos del usuario
                                                        </p>
                                                    </div>

                                                    <!-- Export buttons for Pagos -->
                                                    <div id="export-buttons-container-pagos" class="d-none">
                                                      <div class="btn-group" role="group">
                                                        <a href="#" id="exportExcelPagos" class="btn btn-success btn-sm" style="min-width: 120px;">
                                                          <i class="fas fa-file-excel me-1"></i>
                                                          Exportar Excel
                                                        </a>
                                                        <a href="#" id="exportPdfPagos" class="btn btn-danger btn-sm" style="min-width: 120px;">
                                                          <i class="fas fa-file-pdf me-1"></i>
                                                          Exportar PDF
                                                        </a>
                                                      </div>
                                                    </div>

                                                    <!-- Loader for Pagos -->
                                                    <div id="loading-container-pagos" class="text-center p-4">
                                                      <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando...</span>
                                                      </div>
                                                      <div class="mt-2">Cargando pagos...</div>
                                                    </div>

                                                    <!-- Tabla envuelta en contenedor oculto -->
                                                    <div id="table-content-pagos" style="display: none;">
                                                      <div class="table-responsive">
                                                        <table id="alternative-page-datatable2" class="table table-centered datatable dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                          <thead>
                                                            <tr>
                                                                <th style="width: 40px">ID</th>
                                                                <th>Reserva ID</th>
                                                                <th>Método</th>
                                                                <th>Monto</th>
                                                                <th>Estado</th>
                                                                <th>Fecha Pago</th>
                                                                <th style="width: 100px">Acciones</th>
                                                            </tr>
                                                          </thead>
                                                        <tbody>
                                                            <tr th:each="pago : ${pagos}">
                                                                <td th:text="${pago.pagoId}"></td>
                                                                <td th:text="${pago.reserva.reservaId}"></td>
                                                                <td>
                                                                    <img th:src="${#strings.toLowerCase(pago.metodoPago.metodoPago) == 'yape' ? '/assets/images/companies/Yape.png' :
                                                                                (#strings.toLowerCase(pago.metodoPago.metodoPago) == 'plin' ? '/assets/images/companies/Plin.png' :
                                                                                '/assets/images/companies/Izipay.jpg')}"
                                                                         class="avatar-xs rounded-circle me-2">
                                                                    <span th:text="${pago.metodoPago.metodoPago}"></span>
                                                                </td>
                                                                <td th:text="${'S/ ' + #numbers.formatDecimal(pago.monto, 1, 2)}"></td>
                                                                <td>
                                                                    <span th:switch="${pago.estadoTransaccion.name()}" class="badge">
                                                                        <span th:case="completado" class="badge bg-success-subtle text-success font-size-12">Completado</span>
                                                                        <span th:case="pendiente" class="badge bg-warning-subtle text-warning font-size-12">Pendiente</span>
                                                                        <span th:case="fallido" class="badge bg-danger-subtle text-danger font-size-12">Fallido</span>
                                                                    </span>
                                                                </td>
                                                                <td th:text="${pago.fechaPago != null} ? ${#temporals.format(pago.fechaPago, 'dd/MM/yyyy HH:mm')} : 'N/A'"></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary"
                                                                            data-bs-toggle="modal"
                                                                            data-bs-target="#detalleUniversalModal"
                                                                            data-tipo="pago"
                                                                            th:attr="data-id=${pago.pagoId}">
                                                                        <i class="mdi mdi-eye"></i>
                                                                    </button>
                                                                    <a th:if="${pago.fotoComprobanteUrl != null}"
                                                                       th:href="@{${pago.fotoComprobanteUrl}}"
                                                                       class="btn btn-sm btn-info ms-1"
                                                                       target="_blank">
                                                                        <i class="mdi mdi-file-image"></i>
                                                                    </a>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                        </table>
                                                      </div>
                                                    </div>
                                                </div>

                                                <div class="tab-pane fade" id="reembolsos" role="tabpanel"
                                                     aria-labelledby="reembolsos-tab">

                                                    <div class="mt-3">
                                                        <h4 class="card-title mb-1">Reembolsos realizados</h4>
                                                        <p class="card-title-desc mb-0 mt-0">
                                                            Lista de Reembolsos del usuario
                                                        </p>
                                                    </div>

                                                    <!-- Export buttons for Reembolsos -->
                                                    <div id="export-buttons-container-reembolsos" class="d-none">
                                                      <div class="btn-group" role="group">
                                                        <a href="#" id="exportExcelReembolsos" class="btn btn-success btn-sm" style="min-width: 120px;">
                                                          <i class="fas fa-file-excel me-1"></i>
                                                          Exportar Excel
                                                        </a>
                                                        <a href="#" id="exportPdfReembolsos" class="btn btn-danger btn-sm" style="min-width: 120px;">
                                                          <i class="fas fa-file-pdf me-1"></i>
                                                          Exportar PDF
                                                        </a>
                                                      </div>
                                                    </div>

                                                    <!-- Loader for Reembolsos -->
                                                    <div id="loading-container-reembolsos" class="text-center p-4">
                                                      <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando...</span>
                                                      </div>
                                                      <div class="mt-2">Cargando reembolsos...</div>
                                                    </div>

                                                    <!-- Tabla envuelta en contenedor oculto -->
                                                    <div id="table-content-reembolsos" style="display: none;">
                                                      <div class="table-responsive">
                                                        <table id="alternative-page-datatable3" class="table table-centered datatable dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                          <thead>
                                                            <tr>
                                                                <th style="width: 40px">ID</th>
                                                                <th>Pago ID</th>
                                                                <th>Monto</th>
                                                                <th>Estado</th>
                                                                <th>Fecha Reembolso</th>
                                                                <th>Motivo</th>
                                                                <th style="width: 100px">Acciones</th>
                                                            </tr>
                                                          </thead>
                                                        <tbody>
                                                            <tr th:each="reembolso : ${reembolsos}">
                                                                <td th:text="${reembolso.reembolsoId}"></td>
                                                                <td th:text="${reembolso.pago.pagoId}"></td>
                                                                <td th:text="${'S/ ' + #numbers.formatDecimal(reembolso.monto, 1, 2)}"></td>
                                                                <td>
                                                                    <span th:switch="${reembolso.estado != null ? reembolso.estado.name() : 'sin_estado'}" class="badge">
                                                                        <span th:case="pendiente" class="badge bg-warning-subtle text-warning font-size-12">Pendiente</span>
                                                                        <span th:case="completado" class="badge bg-success-subtle text-success font-size-12">Completado</span>
                                                                        <span th:case="rechazado" class="badge  bg-danger-subtle text-danger font-size-12">Rechazado</span>
                                                                        <span th:case="cancelado" class="badge  bg-secondary-subtle text-secondary font-size-12">Cancelado</span>
                                                                        <span th:case="sin_estado" class="badge bg-secondary-subtle text-secondary font-size-12">Sin estado</span>
                                                                    </span>
                                                                </td>
                                                                <td th:text="${reembolso.fechaReembolso != null} ? ${#temporals.format(reembolso.fechaReembolso, 'dd/MM/yyyy HH:mm')} : 'N/A'"></td>
                                                                <td th:text="${reembolso.motivo != null} ? ${#strings.abbreviate(reembolso.motivo, 20)} : 'Sin motivo'"></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary"
                                                                            data-bs-toggle="modal"
                                                                            data-bs-target="#detalleUniversalModal"
                                                                            data-tipo="reembolso"
                                                                            th:attr="data-id=${reembolso.reembolsoId}">
                                                                        <i class="mdi mdi-eye"></i>
                                                                    </button>
                                                                    <a th:if="${reembolso.fotoComprobacionReembolsoUrl != null}"
                                                                       th:href="@{${reembolso.fotoComprobacionReembolsoUrl}}"
                                                                       class="btn btn-sm btn-info ms-1"
                                                                       target="_blank">
                                                                        <i class="mdi mdi-file-image"></i>
                                                                    </a>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                        </table>
                                                      </div>
                                                    </div>
                                                </div>

                                                <!-- Modal Universal para Detalles -->
                                                <div class="modal fade" id="detalleUniversalModal" tabindex="-1" aria-hidden="true">
                                                    <div class="modal-dialog modal-lg modal-dialog-centered">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="detalleModalTitle">Detalles</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body" id="detalleUniversalContent">
                                                                <!-- Contenido dinámico se cargará aquí -->
                                                                <div class="text-center py-4">
                                                                    <div class="spinner-border text-primary" role="status"></div>
                                                                    <p class="mt-2">Cargando detalles...</p>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- container-fluid -->
                            </div>
                            <!-- End Page-content -->
                        </div>
                        <!-- end main content-->
                    </div>
                </div>

                <div th:replace="~{Superadmin/fragments/footer.html :: footer}"></div>
                <!-- END layout-wrapper -->
            </div>
        </div>
        <!-- Sidebar overlay-->
        <div class="sidebar-overlay"></div>

        <!-- JAVASCRIPT -->
        <div th:replace="~{Superadmin/fragments/foot.html :: foot}"></div>

        <script>
            $(document).ready(function () {
                // Inicializar DataTable para Reservas
                var reservasTable = $('#alternative-page-datatable').DataTable({
                  lengthMenu: [5, 10, 25, 50],
                  pageLength: 5,
                  processing: false,
                  serverSide: false,
                  scrollX: true,
                  autoWidth: false,
                  columnDefs: [
                    {
                      targets: [0, -1], // ID y Acciones
                      orderable: false
                    },
                    {
                      targets: '_all',
                      className: 'text-nowrap'
                    }
                  ],
                  language: {
                    "decimal": "",
                    "emptyTable": "No hay reservas disponibles",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ reservas",
                    "infoEmpty": "Mostrando 0 a 0 de 0 reservas",
                    "infoFiltered": "(filtrado de _MAX_ reservas totales)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "Mostrar _MENU_ reservas",
                    "loadingRecords": "Cargando...",
                    "processing": "Procesando...",
                    "search": "Buscar:",
                    "zeroRecords": "No se encontraron reservas",
                    "paginate": {
                      "first": "Primero",
                      "last": "Último",
                      "next": "<i class='mdi mdi-chevron-right'></i>",
                      "previous": "<i class='mdi mdi-chevron-left'></i>"
                    },
                    "aria": {
                      "sortAscending": ": activar para ordenar ascendente",
                      "sortDescending": ": activar para ordenar descendente"
                    }
                  },
                  initComplete: function() {
                    $("#loading-container-reservas").remove();
                    $("#table-content-reservas").show();
                  },
                  drawCallback: function() {
                    $(".dataTables_paginate > .pagination").addClass("pagination-rounded");
                  }
                });

                // Inicializar DataTable para Pagos
                var pagosTable = $('#alternative-page-datatable2').DataTable({
                  lengthMenu: [5, 10, 25, 50],
                  pageLength: 5,
                  processing: false,
                  serverSide: false,
                  scrollX: true,
                  autoWidth: false,
                  columnDefs: [
                    {
                      targets: [0, -1], // ID y Acciones
                      orderable: false
                    },
                    {
                      targets: '_all',
                      className: 'text-nowrap'
                    }
                  ],
                  language: {
                    "decimal": "",
                    "emptyTable": "No hay pagos disponibles",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ pagos",
                    "infoEmpty": "Mostrando 0 a 0 de 0 pagos",
                    "infoFiltered": "(filtrado de _MAX_ pagos totales)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "Mostrar _MENU_ pagos",
                    "loadingRecords": "Cargando...",
                    "processing": "Procesando...",
                    "search": "Buscar:",
                    "zeroRecords": "No se encontraron pagos",
                    "paginate": {
                      "first": "Primero",
                      "last": "Último",
                      "next": "<i class='mdi mdi-chevron-right'></i>",
                      "previous": "<i class='mdi mdi-chevron-left'></i>"
                    },
                    "aria": {
                      "sortAscending": ": activar para ordenar ascendente",
                      "sortDescending": ": activar para ordenar descendente"
                    }
                  },
                  initComplete: function() {
                    $("#loading-container-pagos").remove();
                    $("#table-content-pagos").show();
                  },
                  drawCallback: function() {
                    $(".dataTables_paginate > .pagination").addClass("pagination-rounded");
                  }
                });

                // Inicializar DataTable para Reembolsos
                var reembolsosTable = $('#alternative-page-datatable3').DataTable({
                  lengthMenu: [5, 10, 25, 50],
                  pageLength: 5,
                  processing: false,
                  serverSide: false,
                  scrollX: true,
                  autoWidth: false,
                  columnDefs: [
                    {
                      targets: [0, -1], // ID y Acciones
                      orderable: false
                    },
                    {
                      targets: '_all',
                      className: 'text-nowrap'
                    }
                  ],
                  language: {
                    "decimal": "",
                    "emptyTable": "No hay reembolsos disponibles",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ reembolsos",
                    "infoEmpty": "Mostrando 0 a 0 de 0 reembolsos",
                    "infoFiltered": "(filtrado de _MAX_ reembolsos totales)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "Mostrar _MENU_ reembolsos",
                    "loadingRecords": "Cargando...",
                    "processing": "Procesando...",
                    "search": "Buscar:",
                    "zeroRecords": "No se encontraron reembolsos",
                    "paginate": {
                      "first": "Primero",
                      "last": "Último",
                      "next": "<i class='mdi mdi-chevron-right'></i>",
                      "previous": "<i class='mdi mdi-chevron-left'></i>"
                    },
                    "aria": {
                      "sortAscending": ": activar para ordenar ascendente",
                      "sortDescending": ": activar para ordenar descendente"
                    }
                  },
                  initComplete: function() {
                    $("#loading-container-reembolsos").remove();
                    $("#table-content-reembolsos").show();
                  },
                  drawCallback: function() {
                    $(".dataTables_paginate > .pagination").addClass("pagination-rounded");
                  }
                });

                // Ocultar los selectores de longitud por defecto
                $(".dataTables_length").hide();

                // Posicionar botones de exportación para Reservas
                setTimeout(function() {
                  var reservasDatatableWrapper = $('#alternative-page-datatable').closest('.dataTables_wrapper');
                  if (reservasDatatableWrapper.length > 0) {
                    var reservasTopContainer = reservasDatatableWrapper.find('.dataTables_length').parent();
                    if (reservasTopContainer.length > 0) {
                      var reservasExportButtonsContainer = $('#export-buttons-container-reservas');
                      reservasExportButtonsContainer.removeClass('d-none');
                      
                      var reservasButtonWrapper = $('<div class="col-sm-12 col-md-6 d-flex align-items-center"></div>');
                      reservasButtonWrapper.append(reservasExportButtonsContainer);
                      reservasTopContainer.prepend(reservasButtonWrapper);
                      
                      var reservasFilterContainer = reservasDatatableWrapper.find('.dataTables_filter').parent();
                      if (reservasFilterContainer.length > 0) {
                        reservasFilterContainer.removeClass().addClass('col-sm-12 col-md-6');
                      }
                      
                      reservasTopContainer.addClass('row');
                    }
                  }
                }, 100);

                // Posicionar botones de exportación para Pagos
                setTimeout(function() {
                  var pagosDatatableWrapper = $('#alternative-page-datatable2').closest('.dataTables_wrapper');
                  if (pagosDatatableWrapper.length > 0) {
                    var pagosTopContainer = pagosDatatableWrapper.find('.dataTables_length').parent();
                    if (pagosTopContainer.length > 0) {
                      var pagosExportButtonsContainer = $('#export-buttons-container-pagos');
                      pagosExportButtonsContainer.removeClass('d-none');
                      
                      var pagosButtonWrapper = $('<div class="col-sm-12 col-md-6 d-flex align-items-center"></div>');
                      pagosButtonWrapper.append(pagosExportButtonsContainer);
                      pagosTopContainer.prepend(pagosButtonWrapper);
                      
                      var pagosFilterContainer = pagosDatatableWrapper.find('.dataTables_filter').parent();
                      if (pagosFilterContainer.length > 0) {
                        pagosFilterContainer.removeClass().addClass('col-sm-12 col-md-6');
                      }
                      
                      pagosTopContainer.addClass('row');
                    }
                  }
                }, 100);

                // Posicionar botones de exportación para Reembolsos
                setTimeout(function() {
                  var reembolsosDatatableWrapper = $('#alternative-page-datatable3').closest('.dataTables_wrapper');
                  if (reembolsosDatatableWrapper.length > 0) {
                    var reembolsosTopContainer = reembolsosDatatableWrapper.find('.dataTables_length').parent();
                    if (reembolsosTopContainer.length > 0) {
                      var reembolsosExportButtonsContainer = $('#export-buttons-container-reembolsos');
                      reembolsosExportButtonsContainer.removeClass('d-none');
                      
                      var reembolsosButtonWrapper = $('<div class="col-sm-12 col-md-6 d-flex align-items-center"></div>');
                      reembolsosButtonWrapper.append(reembolsosExportButtonsContainer);
                      reembolsosTopContainer.prepend(reembolsosButtonWrapper);
                      
                      var reembolsosFilterContainer = reembolsosDatatableWrapper.find('.dataTables_filter').parent();
                      if (reembolsosFilterContainer.length > 0) {
                        reembolsosFilterContainer.removeClass().addClass('col-sm-12 col-md-6');
                      }
                      
                      reembolsosTopContainer.addClass('row');
                    }
                  }
                }, 100);

                // Configurar botones de exportación para Reservas
                $(document).on('click', '#exportExcelReservas', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/reservas/export/excel';
                });

                $(document).on('click', '#exportPdfReservas', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/reservas/export/pdf';
                });

                // Configurar botones de exportación para Pagos
                $(document).on('click', '#exportExcelPagos', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/pagos/export/excel';
                });

                $(document).on('click', '#exportPdfPagos', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/pagos/export/pdf';
                });

                // Configurar botones de exportación para Reembolsos
                $(document).on('click', '#exportExcelReembolsos', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/reembolsos/export/excel';
                });

                $(document).on('click', '#exportPdfReembolsos', function(e) {
                  e.preventDefault();
                  var userId = window.location.pathname.split('/')[3]; // Obtener ID del usuario de la URL
                  window.location.href = '/superadmin/usuarios/' + userId + '/reembolsos/export/pdf';
                });

                // Ajustar tablas cuando se cambian las pestañas
                $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (event) {
                  var tabID = $(event.target).attr('data-bs-target');
                  setTimeout(function () {
                    if (tabID === '#reservas') {
                      reservasTable.columns.adjust().responsive.recalc();
                    } else if (tabID === '#pagos') {
                      pagosTable.columns.adjust().responsive.recalc();
                    } else if (tabID === '#reembolsos') {
                      reembolsosTable.columns.adjust().responsive.recalc();
                    }
                  }, 100);
                });
            });

        </script>
        
        <!-- Asegurar anchos automáticos en cabeceras y margen inferior -->

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                $('#detalleUniversalModal').on('show.bs.modal', function(event) {
                    const button = $(event.relatedTarget);
                    const tipo = button.data('tipo'); // 'reserva', 'pago' o 'reembolso'
                    const id = button.data('id');

                    // Actualizar título
                    $('#detalleModalTitle').text(`Detalles de ${tipo.charAt(0).toUpperCase() + tipo.slice(1)}`);

                    // Cargar contenido con ruta absoluta
                    $('#detalleUniversalContent').load(`/superadmin/${tipo}s/detalles/${id}`, function(response, status) {
                        if (status === "error") {
                            $(this).html('<div class="alert alert-danger">Error al cargar los detalles</div>');
                        }
                    });
                });
            });
        </script>

        <script>
            // Inicializar tooltips
            document.addEventListener('DOMContentLoaded', function() {
                const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                tooltipTriggerList.map(function (tooltipTriggerEl) {
                    return new bootstrap.Tooltip(tooltipTriggerEl);
                });
            });

            function confirmarBaneo(button) {
                const form = button.closest('form');
                Swal.fire({
                    title: '¿Confirmar baneo?',
                    html: `<p>Se cancelarán todas sus reservas activas.</p>
              <input type="text" id="motivo" class="swal2-input" placeholder="Motivo (opcional)">`,
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'Banear',
                    cancelButtonText: 'Cancelar',
                    focusConfirm: false,
                    preConfirm: () => {
                        const motivo = document.getElementById('motivo').value;
                        if (motivo) {
                            const input = document.createElement('input');
                            input.type = 'hidden';
                            input.name = 'motivo';
                            input.value = motivo;
                            form.appendChild(input);
                        }
                        return true;
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        form.submit();
                    }
                });
            }
        </script>

        <style>
        #alternative-page-datatable th,
        #alternative-page-datatable td,
        #alternative-page-datatable2 th,
        #alternative-page-datatable2 td,
        #alternative-page-datatable3 th,
        #alternative-page-datatable3 td {
            width: auto !important;
        }

        #alternative-page-datatable,
        #alternative-page-datatable2,
        #alternative-page-datatable3 {
            width: 100% !important;
            table-layout: auto !important;
            margin-bottom: 15px !important;
        }

        /* Limpiar estilos específicos de DataTables */
        .dataTables_wrapper .table {
            width: 100% !important;
        }
        </style>
    </body>


    <!-- Mirrored from themesdesign.in/nazox/layouts/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 30 Aug 2024 19:31:03 GMT -->
</html>
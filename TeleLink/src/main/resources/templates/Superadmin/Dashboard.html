<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

    <!-- Mirrored from themesdesign.in/nazox/layouts/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 30 Aug 2024 19:30:18 GMT -->
    <head th:replace="~{Superadmin/fragments/head.html :: head(title='Inicio')}"></head>

    <body data-sidebar="dark" class="vertical-collpsed">

        <!-- <body data-layout="horizontal" data-topbar="dark"> -->

        <!-- Begin page -->
        <div id="layout-wrapper">

            <div th:replace="~{Superadmin/fragments/header.html :: header(title='Perfil')}"></div>

            <!-- ========== Left Sidebar Start ========== -->
            <div th:replace="~{Superadmin/fragments/sidebar.html :: sidebar}"></div>
            <!-- Left Sidebar End -->



            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <div class="main-content">

                <div class="page-content">
                    <div class="container-fluid">

                        <div class="row">
                            <div class="col-xl-9">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="card" style="background: linear-gradient(90deg, #f47d56, #ffb98a);">
                                            <div class="card-body">
                                                <div class="d-flex">
                                                    <div class="flex-1 overflow-hidden">
                                                        <p class="text-truncate font-size-15 mb-2 text-white">Número de Reservas</p>
                                                        <h4 class="mb-0 text-white" th:text="${numeroReservasMes != null ? numeroReservasMes : '0'}"></h4>
                                                    </div>
                                                    <div class="text-primary ms-auto">
                                                        <i class="ri-stack-line font-size-24"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body border-top py-3">
                                                <div class="text-truncate">
                                                    <span th:if="${diferencia != null}"
                                                          th:class="${diferencia < 0 ? 'badge bg-danger-subtle text-danger font-size-11' : 'badge bg-success-subtle text-success font-size-11'}">
                                                        <i th:class="${diferencia < 0 ? 'mdi mdi-menu-down' : 'mdi mdi-plus'}"></i>
                                                        <span th:text="${diferencia}"></span>
                                                    </span>
                                                    <span th:if="${diferencia == null}" class="badge bg-secondary-subtle text-secondary font-size-11">
                                                        <i class="mdi mdi-information-outline"></i> Sin datos
                                                    </span>
                                                    <span class="text-white ms-2">Desde el periodo anterior</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card" style="background: linear-gradient(90deg, #40b370, #8df6b7);">
                                            <div class="card-body">
                                                <div class="d-flex">
                                                    <div class="flex-1 overflow-hidden">
                                                        <p class="text-truncate font-size-15 mb-2 text-white">Monto de Reservas</p>
                                                        <h4 class="mb-0 text-white">
                                                            <span th:if="${montoMensual != null}" th:text="'S/ ' + ${#numbers.formatDecimal(montoMensual, 1, 2, 'POINT')}"></span>
                                                            <span th:if="${montoMensual == null}">S/ 0.00</span>
                                                        </h4>
                                                    </div>
                                                    <div class="text-primary ms-auto">
                                                        <i class="ri-store-2-line font-size-24"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body border-top py-3">
                                                <div class="text-truncate">
                                                    <span th:if="${montoMensual != null and montoMensualPasado != null}">
                                                        <span th:class="${(montoMensual - montoMensualPasado) < 0? 'badge bg-danger-subtle text-danger font-size-11' : 'badge bg-success-subtle text-success font-size-11'}">
                                                            <i th:class="${(montoMensual - montoMensualPasado) < 0 ? 'mdi mdi-menu-down' : 'mdi mdi-plus'}"></i>
                                                            <span th:text="'S/ ' + ${#numbers.formatDecimal(montoMensual - montoMensualPasado, 1, 2, 'POINT')}"></span>
                                                        </span>
                                                    </span>
                                                                                        <span th:if="${montoMensual == null or montoMensualPasado == null}"
                                                                                              class="badge bg-secondary-subtle text-secondary font-size-11">
                                                        <i class="mdi mdi-information-outline"></i> Sin datos
                                                    </span>
                                                    <span class="text-white ms-2">Desde el periodo anterior</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card" style="background: linear-gradient(90deg, #3ab2c3, #8ce5f3);">
                                            <div class="card-body">
                                                <div class="d-flex">
                                                    <div class="flex-1 overflow-hidden">
                                                        <p class="text-truncate font-size-15 mb-2 text-white">Promedio por Reserva</p>
                                                        <h4 class="mb-0 text-white">
                                                            <span th:if="${promedioMensual != null}" th:text="'S/ ' + ${#numbers.formatDecimal(promedioMensual, 1, 2, 'POINT')}"></span>
                                                            <span th:if="${promedioMensual == null}">S/ 0.00</span>
                                                        </h4>
                                                    </div>
                                                    <div class="text-primary ms-auto">
                                                        <i class="ri-briefcase-4-line font-size-24"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body border-top py-3">
                                                <div class="text-truncate">
                                                    <span th:if="${promedioMensual != null and promedioMensualPasado != null}">
                                                        <span th:class="${(promedioMensual - promedioMensualPasado) < 0? 'badge bg-danger-subtle text-danger font-size-11' : 'badge bg-success-subtle text-success font-size-11'}">
                                                            <i th:class="${(promedioMensual - promedioMensualPasado) < 0 ? 'mdi mdi-menu-down' : 'mdi mdi-plus'}"></i>
                                                            <span th:text="'S/ ' + ${#numbers.formatDecimal(promedioMensual - promedioMensualPasado, 1, 2, 'POINT')}"></span>
                                                        </span>
                                                    </span>
                                                                                        <span th:if="${promedioMensual == null or promedioMensualPasado == null}"
                                                                                              class="badge bg-secondary-subtle text-secondary font-size-11">
                                                        <i class="mdi mdi-information-outline"></i> Sin datos
                                                    </span>
                                                    <span class="text-white ms-2">Desde el periodo anterior</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xl-4">
                                        <div class="card">
                                            <div class="card-header pb-1">
                                                <div class="d-flex">
                                                    <h4 class="card-title my-2">Últimos avisos</h4>
                                                    <a th:href="@{/superadmin/avisos}" class="btn btn-sm btn-outline-primary border-light my-1 ms-auto">Ver todo</a>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div data-simplebar style="height: 475px;">
                                                    <ul class="list-unstyled activity-wid">
                                                        <li th:if="${avisos == null or avisos.isEmpty()}">
                                                            <p class="text-muted">No hay avisos recientes</p>
                                                        </li>
                                                        <li class="activity-list" th:each="aviso : ${avisos}" th:if="${avisos != null and not avisos.isEmpty()}">
                                                            <div class="activity-icon avatar-xs">
                                                                <span class="avatar-title bg-primary-subtle text-primary rounded-circle">
                                                                    <i class="ri-newspaper-line"></i>
                                                                </span>
                                                            </div>
                                                            <div>
                                                                <h5 class="font-size-13" style="display: flex; align-items: end;">
                                                                    <span th:text="${aviso.fechaAviso != null ? #temporals.format(aviso.fechaAviso, 'dd MMM, yyyy') : 'Fecha no disponible'}"></span>
                                                                    <small class="ms-1 text-muted bold"
                                                                           th:text="${aviso.fechaAviso != null ? #temporals.format(aviso.fechaAviso, 'hh:mm a') : ''}"></small>
                                                                </h5>
                                                                <div>
                                                                    <p class="text-muted mb-0"
                                                                       th:text="'Nueva noticia: ' + ${aviso.tituloAviso != null ? aviso.tituloAviso : 'Sin título'}"></p>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-8">
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="card">
                                                    <div class="card-header pb-1">
                                                        <div class="d-flex">
                                                            <h4 class="card-title my-2">Aviso actual</h4>
                                                            <!-- Mostrar botón de modificar solo si no es el default -->
                                                            <a th:if="${avisoActivo != null and !avisoActivo.esEstadoDefault()}"
                                                               th:href="@{'/superadmin/editarAviso/' + ${avisoActivo.avisoId}}"
                                                               class="btn btn-sm btn-outline-success my-1 ms-auto">
                                                                Modificar aviso
                                                            </a>
                                                            <!-- Opcional: Botón para editar el default (si lo permites) -->
                                                            <a th:if="${avisoActivo != null and avisoActivo.esEstadoDefault()}"
                                                               th:href="@{'/superadmin/editarAviso/' + ${avisoActivo.avisoId}}"
                                                               class="btn btn-sm btn-outline-info my-1 ms-auto">
                                                                Editar aviso default
                                                            </a>
                                                        </div>
                                                    </div>

                                                    <!-- Contenido del aviso -->
                                                    <div class="card-body py-1" th:if="${avisoActivo != null}">
                                                        <!-- Badge para identificar el default -->
                                                        <h4 class="card-title my-2" th:text="${avisoActivo.tituloAviso} ?: 'Sin título'"></h4>
                                                        <p class="card-text text-muted mb-1" th:text="${avisoActivo.textoAviso} ?: 'No hay contenido disponible'"></p>
                                                    </div>

                                                    <!-- Imagen del aviso -->
                                                    <div class="px-3 " th:if="${avisoActivo != null and avisoActivo.fotoAvisoUrl != null}">
                                                        <img class="card-img-bottom img-fluid object-fit-cover"
                                                             style="max-height: 393px;"
                                                             th:src="${avisoActivo.fotoAvisoUrl}"
                                                             alt="Imagen del aviso"
                                                             onerror="this.src='/assets/images/BienvenidaSanMiguel.png'">
                                                    </div>

                                                    <!-- Si NO hay aviso activo -->
                                                    <div th:if="${avisoActivo == null}" class="card-body">
                                                        <p class="text-muted">No hay avisos disponibles</p>
                                                    </div>

                                                    <!-- Si SÍ hay aviso activo -->
                                                    <div th:if="${avisoActivo != null}" class="my-1 px-3">
                                                        <p class="card-text mt-1">
                                                            <small>Creado: </small>
                                                            <small class="text-muted"
                                                                   th:text="${avisoActivo.fechaAviso != null ? #temporals.format(avisoActivo.fechaAviso, 'dd/MM/yyyy HH:mm') : 'Fecha no disponible'}">
                                                            </small>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3">
                                <div class="card">
                                    <div class="card-header pb-1">
                                        <div class="d-flex">
                                            <h4 class="card-title my-2">Análisis de reservas</h4>
                                            <!-- Opcional: Botón para editar el default (si lo permites) -->
                                            <a th:href="@{'/superadmin/reservas'}"
                                               class="btn btn-sm btn-outline-info my-1 ms-auto">
                                                Ver todas las reservas
                                            </a>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div id="chart" class="apex-charts"></div>
                                    </div>
                                </div>

                                <div class="card">
                                    <div class="card-header pb-1">
                                        <div class="d-flex">
                                            <h4 class="card-title my-2">Fuentes de ingreso</h4>
                                        </div>
                                    </div>
                                    <div class="card-body py-1">
                                        <div>
                                            <div class="table-responsive mt-1">
                                                <table class="table table-hover mb-0 table-centered table-nowrap">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>Medio</th>
                                                            <th>Mensual</th>
                                                            <th>Semanal</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td style="width: 60px;">
                                                                <div class="avatar-xs">
                                                                    <img src="/assets/images/companies/Yape.png"
                                                                         class="img-fluid rounded-circle"
                                                                         alt="Yape"
                                                                         style="width: 30px; height: 30px; object-fit: contain;">
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <h5 class="font-size-14 mb-0">Yape</h5>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoYapeMensual != null ? 'S/. ' + pagoYapeMensual : 'S/. 0.00'}"></p>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoYapeSemanal != null ? 'S/. ' + pagoYapeSemanal : 'S/. 0.00'}"></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width: 60px;">
                                                                <div class="avatar-xs">
                                                                    <img src="/assets/images/companies/Plin.png"
                                                                         class="img-fluid rounded-circle"
                                                                         alt="Plin"
                                                                         style="width: 30px; height: 30px; object-fit: contain;">
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <h5 class="font-size-14 mb-0">Plin</h5>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoPlinMensual != null ? 'S/. ' + pagoPlinMensual : 'S/. 0.00'}"></p>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoPlinSemanal != null ? 'S/. ' + pagoPlinSemanal : 'S/. 0.00'}"></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width: 60px;">
                                                                <div class="avatar-xs">
                                                                    <img src="/assets/images/companies/Izipay.jpg"
                                                                         class="img-fluid rounded-circle"
                                                                         alt="Izipay"
                                                                         style="width: 30px; height: 30px; object-fit: contain;">
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <h5 class="font-size-14 mb-0">Izipay</h5>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoIzipayMensual != null ? 'S/. ' + pagoIzipayMensual : 'S/. 0.00'}"></p>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoIzipaySemanal != null ? 'S/. ' + pagoIzipaySemanal : 'S/. 0.00'}"></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width: 60px;">
                                                                <div class="avatar-xs">
                                                                    <img src="/assets/images/companies/Efectivo.png"
                                                                         class="img-fluid"
                                                                         alt="Efectivo"
                                                                         style="width: 30px; height: 30px; object-fit: contain;">
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <h5 class="font-size-14 mb-0">Efectivo</h5>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoEfectivoMensual != null ? 'S/. ' + pagoEfectivoMensual : 'S/. 0.00'}"></p>
                                                            </td>
                                                            <td>
                                                                <p class="text-muted mb-0" th:text="${pagoEfectivoSemanal != null ? 'S/. ' + pagoEfectivoSemanal : 'S/. 0.00'}"></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end row -->
                    </div>

                </div>
                <!-- End Page-content -->

                <div th:replace="~{Superadmin/fragments/footer.html :: footer}"></div>

            </div>
            <!-- end main content-->

        </div>
        <!-- END layout-wrapper -->

        <!-- Right bar overlay-->
        <div class="sidebar-overlay"></div>

        <!-- JAVASCRIPT -->
        <div th:replace="~{Superadmin/fragments/foot.html :: foot}"></div>

        <script th:inline="javascript">
            // Asegúrate de que chartData sea un array con 4 valores
            var chartData = /*[[${chartData}]]*/ [0, 0, 0, 0];
            var chartLabels = ['Gimnasio', 'Fútbol', 'Piscina', 'Cancha Multiusos'];

            // Verifica los datos en consola para depuración
            console.log("Datos del gráfico:", chartData);

            var options = {
                chart: {
                    type: 'donut',
                    height: 300
                },
                colors: ["#5664d2", "#1cbb8c", "#ff6384", "#ffcd56"],
                series: chartData,
                labels: chartLabels,
                plotOptions: {
                    pie: {
                        donut: {
                            size: '65%',
                            labels: {
                                show: true,
                                total: {
                                    show: true,
                                    label: 'Total Reservas',
                                    formatter: function (w) {
                                        return w.globals.seriesTotals.reduce((a, b) => {
                                            return a + b
                                        }, 0)
                                    }
                                }
                            }
                        }
                    }
                },
                dataLabels: {
                    enabled: true,
                    formatter: function (val, { seriesIndex, w }) {
                        return w.config.series[seriesIndex] + " (" + Math.round(val) + "%)";
                    }
                },
                legend: {
                    position: 'bottom',
                    horizontalAlign: 'center'
                },
                tooltip: {
                    y: {
                        formatter: function(val) {
                            return val + " reservas";
                        }
                    }
                },
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 200
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };

            // Renderizar el gráfico solo si existe el contenedor
            var chartElement = document.querySelector("#chart");
            if (chartElement) {
                var chart = new ApexCharts(chartElement, options);
                chart.render();
            } else {
                console.error("No se encontró el elemento #chart");
            }
        </script>
    </body>


    <!-- Mirrored from themesdesign.in/nazox/layouts/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 30 Aug 2024 19:31:03 GMT -->
</html>